# Usa una imagen base oficial de Python
FROM python:3.11

# ðŸ”§ Instala postgresql-client (para pg_isready)
RUN apt-get update && apt-get install -y postgresql-client

# Establece el directorio de trabajo en el contenedor
WORKDIR /app

# Copia los archivos del proyecto al contenedor
COPY . .

# Instala las dependencias con mayor timeout y mirror alternativo (para evitar errores de red)
RUN pip install --no-cache-dir --timeout=120 -i https://pypi.org/simple/ -r requirements.txt

# Da permisos de ejecuciÃ³n al archivo entrypoint.ls
RUN chmod +x /entrypoint.ls

# Expone el puerto 8000 para la aplicaciÃ³n Django
EXPOSE 8000

# Ejecuta el script de entrypoint
ENTRYPOINT ["entrypoint.ls"]

# Comando por defecto para ejecutar Django
CMD ["python", "manage.py", "runserver", "0.0.0.0:8000"]
